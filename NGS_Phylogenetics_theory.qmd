---
author: "Анна (https://github.com/rybinaanya)"
---

# Филогенетика (теория)

Типичный пайплан состоит из нескольких шагов: 1) Подбор данных 2) Множественное выравнивание 3) Подбор параметров для построения дерева 4) Оценка дерева 5) Визуализация 6) Сравнение с другими деревьями

## Разница между деревьями видов и деревьями генов 

Есть два разных типа деревьев:

-   Дерево видов
-   Дерево генов

В чем они могут отличаться?

-   **Incomplete lineage sorting** - случайное наследование древних полиморфизмов при быстром видообразовании (например при фрагментации популяции). По итогу - неравномерное распределение аллелей по потомкам.

![Пример](fish_detective/Fig_Incomplete_lineage_sorting.png){fig-align="center" width="301"}

-   **Introgression** - Гибридизация двух разных видов и если гибрид плодовитый - часть генов от одного вида "просачивается" в другой

-   **Дупликация генов**

Гомологи имеют общее происхождение, есть 2 варианта: 1) Ортологи - разошлись из-за видообразования. Например альфа-гемоглобины друг с другом 2) Паралоги - в одном геноме 2 копии одного гена. В процессе эволюции их функции могут расходится (нео-функционализация). Например альфа- и бетта- гемоглобины друг с другом

Разные варианты гомологии - в статье [Orthologs, paralogs, and evolutionary genomics](https://www.annualreviews.org/docserver/fulltext/ge/39/1/annurev.genet.39.073003.114725.pdf?expires=1764946833&id=id&accname=guest&checksum=634E845D666DC07FFF16C203017F7E39) [@koonin2005]


-   **Дупликация с последующей потерей генов**. Аналогично incomplete lineage sorting


-   **Горизональный преренос генов у бактерий**, который портит картинку. Если нет уверенности, что это именно он повлиял, можно провести проверку: GC-состава в гене и вокруг него, по кодонам как-то

## Tangled tree - сравнение деревьев между собой (Phylogeny reconcilitation)

Например с помощью пакета R cophyloplot. Можно сравнить получившиеся деревья видов и генов, хозяин - симбионт и тд.

## Модели деревьев (больше инфы на [сайте](https://www.ccg.unam.mx/~vinuesa/Model_fitting_in_phylogenetics.html))

### Substitution model Jukes-Cantor

Все нуклеотиды имеют одинаковую частоту и одинаковую вероятность замены

### Substitution model GTR

Разные частоты нуклеотидов, разные скорости их замен (транзиций и трансверсий)

Например в ML частоты нуклеотидов мы узнаем из множественного выравнивания, а модели скоростей замен программа подбирает сама, чтобы логарифм функии правдоподобия был максимальным.

