---
engine: knitr
author: "Анна Сергеевна Попенко, к.б.н."
---


# Алгоритмы поиска

## Blast

### Скачиваем BLAST

```{bash}
#| eval: false
conda install -c conda-forge -c bioconda blast 
conda install -c bioconda entrez-direct
```

### Скачивание генома E. coli (референс)

```{bash}
#| eval: false
efetch -db nuccore -id NC_000913.3 -format fasta \
> Структуры_данных/15.10.25/Ecoli_K12_MG1655_NC_000913_3.fna
```

### Индексирование референса

```{bash}
makeblastdb -in Структуры_данных/15.10.25/Ecoli_K12_MG1655_NC_000913_3.fna \
    -dbtype nucl \
    -parse_seqids \
    -title "ecoli" \
    -out Структуры_данных/15.10.25/ecoli_k12_nc000913
```

Запуск поиска BLAST:

```{bash}
blastn -query 'Структуры_данных/15.10.25/gene (1).fasta' \
-db Структуры_данных/15.10.25/ecoli_k12_nc000913 \
-out Структуры_данных/15.10.25/gene_vs_ecoli.tsv \
-outfmt "6 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore" \
-evalue 1e-10 -max_target_seqs 10 -num_threads 1
```

```{bash}
cat Структуры_данных/15.10.25/gene_vs_ecoli.tsv
```

## SRA

[SRA Run/File Selector](https://www.ncbi.nlm.nih.gov/Traces/study/){.uri}

[Install NCBI SRA Toolkit](https://github.com/ncbi/sra-tools/wiki/01.-Downloading-SRA-Toolkit)

```{bash}
#| eval: false
curl --output sratoolkit.tar.gz https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/current/sratoolkit.current-mac64.tar.gz
tar -vxzf sratoolkit.tar.gz

```

```{bash}
#| eval: false
conda install sra-tools
```

```{bash}
#| eval: false
# Путь к файлу со списком SRA-идентификаторов
LIST_FILE="Структуры_данных/15.10.25/SRR_Acc_List.txt"

# Папки для хранения скачанных .sra-файлов и итоговых FASTQ
SRA_DIR="Структуры_данных/15.10.25/sra_downloads"
FASTQ_DIR="Структуры_данных/15.10.25/fastq_files"

mkdir -p "${SRA_DIR}" "${FASTQ_DIR}"

while read SRR_ID; do
  echo "$SRR_ID"
  prefetch "${SRR_ID}" -O "${SRA_DIR}"
  fasterq-dump "${SRR_ID}" --outdir "${FASTQ_DIR}" --split-files --skip-technical --threads 1
done < "${LIST_FILE}"

```

Doesnt work...